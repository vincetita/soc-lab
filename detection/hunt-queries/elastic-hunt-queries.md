# Elastic SIEM Hunt Queries (Security Onion)

These queries are used in the Security Onion SOC UI to correlate alerts and events generated by attack simulations.

---

## 1. All Activity from Kali Attacker

source.ip: 192.168.20.129 OR source.ip: 192.168.117.129


Use this as the **starting point** for investigations.

---

## 2. Nmap Reconnaissance Detection

event.category: network AND
source.ip: 192.168.20.129 AND
destination.port: (22 OR 80 OR 443 OR 9200)


Look for:
- Multiple ports
- Short connection durations
- SYN scan behavior

MITRE:
- T1046

---

## 3. Web Enumeration (curl / gobuster)

event.category: network AND
network.protocol: http AND
source.ip: 192.168.20.129


Pivot on:
- url.path
- http.response.status_code
- user_agent

MITRE:
- T1595

---

## 4. Suspicious User-Agent Detection

user_agent: ("curl*" OR "ReconBot*" OR "gobuster*")

Purpose:
- Detect scripted or automated web activity

---

## 5. SSH Brute Force Correlation

destination.ip: 192.168.117.128 AND
network.protocol: ssh

Enhance with:

event.outcome: failure


MITRE:
- T1110

---

## 6. Timeline Correlation (Kill Chain)

Use Timeline view to correlate:
1. Recon (nmap)
2. Web enum (curl/gobuster)
3. Credential abuse (hydra)

This demonstrates multi-stage attack awareness.

